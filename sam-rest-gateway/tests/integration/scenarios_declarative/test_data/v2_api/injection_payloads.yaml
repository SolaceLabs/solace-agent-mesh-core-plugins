test_case_id: "v2_security_injection_payloads"
description: "Tests that the API handles common injection payloads as literal strings"
tags: ["rest_gateway", "v2", "security", "input_validation"]

llm_interactions:
  - static_response:
      choices:
        - message:
            role: "assistant"
            content: "I have received your input."
          finish_reason: "stop"

gateway_input:
  endpoint: "/api/v2/tasks"
  method: "POST"
  auth_token: "valid"
  form_data:
    agent_name: "TestAgent"
    prompt: "' OR 1=1; --"

enable_polling: true
max_polling_attempts: 5

expected_gateway_output:
  - status_code: 202 # Task accepted
  - status_code: 200 # Task completed
    response_json_matches:
      status:
        state: "completed"
    response_contains: "I have received your input."
